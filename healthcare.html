<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Statmint — Healthcare Stocks</title>
  <!-- ✅ Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 40px;
      max-width: 800px;
      margin: auto;
    }
    h1 {
      color: #2c3e50;
    }
    #stockChart {
      margin-top: 20px;
    }
    a {
      display: inline-block;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

  <a href="index.html">← Back to Home</a>
  <h1>Healthcare Stocks — Live Chart</h1>
  <p>This page shows a live healthcare stock price chart using Yahoo Finance API and Chart.js.</p>

  <!-- ✅ Canvas for Chart.js -->
  <canvas id="stockChart" width="800" height="400"></canvas>

  <!-- ✅ Script: API call + Chart.js -->
  <script>
    // ✅ Your RapidAPI credentials
    const options = {
      method: 'GET',
      headers: {
        'X-RapidAPI-Host': 'apidojo-yahoo-finance-v1.p.rapidapi.com',
        'X-RapidAPI-Key': '3a1d738f20msh37d570357c5e28fp1bb20djsnfa30b534dd5f'
      }
    };

    // ✅ Choose a healthcare stock symbol here
    const symbol = 'PFE'; // Pfizer, for example

    // ✅ Fetch time series data
    fetch(`https://apidojo-yahoo-finance-v1.p.rapidapi.com/stock/v2/get-timeseries?symbol=${symbol}&region=US`, options)
      .then(response => response.json())
      .then(data => {
        if (!data.timeseries || !data.timeseries.timestamp) {
          throw new Error('No timeseries data found.');
        }

        // ✅ Extract data
        const timestamps = data.timeseries.timestamp;
        const closes = data.timeseries.close;

        // ✅ Format dates for labels
        const labels = timestamps.map(ts => {
          const date = new Date(ts * 1000);
          return date.toLocaleDateString();
        });

        // ✅ Create Chart.js chart
        const ctx = document.getElementById('stockChart').getContext('2d');
        new Chart(ctx, {
          type: 'line',
          data: {
            labels: labels.reverse(),
            datasets: [{
              label: `${symbol} Closing Price (USD)`,
              data: closes.reverse(),
              borderColor: 'rgba(75, 192, 192, 1)',
              backgroundColor: 'rgba(75, 192, 192, 0.2)',
              tension: 0.1,
              fill: true
            }]
          },
          options: {
            responsive: true,
            plugins: {
              title: {
                display: true,
                text: `${symbol} Closing Prices`
              }
            },
            scales: {
              x: {
                title: {
                  display: true,
                  text: 'Date'
                }
              },
              y: {
                title: {
                  display: true,
                  text: 'Price (USD)'
                }
              }
            }
          }
        });

      })
      .catch(err => {
        console.error(err);
        alert('Error loading stock data. Check the console for details.');
      });
  </script>

</body>
</html>
